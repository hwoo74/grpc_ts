version: '3.8'

services:
  # 서비스 이름: 원하는 이름을 지정합니다.
  node-dev:
    # 1. 빌드 설정: 현재 디렉토리의 Dockerfile을 사용합니다.
    build:
      context: .
      dockerfile: Dockerfile
    
    # 2. 컨테이너 이름: 컨테이너에 고정된 이름을 지정하여 쉽게 접속할 수 있도록 합니다.
    container_name: node-nvm-dev-container
    
    # 3. 볼륨 마운트: 호스트의 현재 디렉토리(.)를 컨테이너의 작업 디렉토리와 공유합니다.
    #    코드를 호스트에서 수정하면 컨테이너에 즉시 반영됩니다.
    volumes:
      - .:/usr/src/app
    
    # 4. 포트 포워딩 (선택 사항): Node.js 앱이 3000번 포트로 실행될 경우를 대비합니다.
    ports:
      - "3000:3000"     # Node.js 웹 앱 (기본)
      - "50051:50051"   # gRPC 서비스 (일반적인 포트)
      - "8080:8080"     # 대체 웹 서비스 또는 디버깅
      
    # 5. 컨테이너가 종료되지 않도록 설정:
    #    개발 환경이므로 컨테이너를 항상 실행 상태로 유지해야 접속 가능합니다.
    #    Dockerfile의 CMD ["tail", "-f", "/dev/null"]이 이를 담당합니다.
    tty: true
    stdin_open: true